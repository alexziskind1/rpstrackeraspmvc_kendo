/**
 * Kendo UI v2023.2.718 (http://www.telerik.com/kendo-ui)
 * Copyright 2023 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Kendo UI commercial licenses may be obtained at
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("kendo.data.js"),require("kendo.treelist.js"),require("kendo.core.js"),require("kendo.html.button.js"),require("kendo.menu.js"),require("kendo.dialog.js"),require("kendo.form.js"),require("kendo.upload.js"),require("kendo.window.js")):"function"==typeof define&&define.amd?define(["kendo.data.min","kendo.treelist.min","kendo.core.min","kendo.html.button.min","kendo.menu.min","kendo.dialog.min","kendo.form.min","kendo.upload.min","kendo.window.min"],e):((t="undefined"!=typeof globalThis?globalThis:t||self).kendoorgchart=t.kendoorgchart||{},t.kendoorgchart.js=e())}(this,(function(){!function(t,e){var i=t.extend,n=kendo.data,a=n.Query,r=n.DataSource,s=n.TreeListDataSource,o=n.Model,d=n.ObservableArray,l=o.define({id:"id",parentId:"parentId",fields:{id:{type:"number",editable:!1},parentId:{type:"number",nullable:!0},name:{type:"string",validation:{required:!0}},title:{type:"string"},avatar:{type:"string"}},init:function(t){o.fn.init.call(this,t),this._loaded=!1,this.parentIdField||(this.parentIdField="parentId"),this.nameField||(this.nameField="name"),this.titleField||(this.titleField="title"),this.avatarField||(this.avatarField="avatar"),this.parentId=this.get(this.parentIdField),this.name=this.get(this.nameField),this.title=this.get(this.titleField),this.avatar=this.get(this.avatarField)},accept:function(t){o.fn.accept.call(this,t),this.parentId=this.get(this.parentIdField),this.name=this.get(this.nameField),this.title=this.get(this.titleField),this.avatar=this.get(this.avatarField)},set:function(t,e,i){"parentId"==t&&"parentId"!=this.nameField&&(this[this.parentIdField]=e),"name"==t&&"name"!=this.nameField&&(this[this.nameField]=e),"title"==t&&"title"!=this.titleField&&(this[this.titleField]=e),"avatar"==t&&"avatar"!=this.avatarField&&(this[this.avatarField]=e),o.fn.set.call(this,t,e,i),t==this.parentIdField&&(this.parentId=this.get(this.parentIdField)),t==this.nameField&&(this.name=this.get(this.nameField)),t==this.titleField&&(this.title=this.get(this.titleField)),t==this.avatarField&&(this.avatar=this.get(this.avatarField))},loaded:function(t){if(t===e)return this._loaded;this._loaded=t},shouldSerialize:function(t){return o.fn.shouldSerialize.call(this,t)&&"_loaded"!==t&&"_error"!=t&&"_edit"!=t&&!("parentId"!==this.parentIdField&&"parentId"===t)}});l.parentIdField="parentId",l.nameField="name",l.titleField="title",l.avatarField="avatar",l.define=function(t,i){i===e&&(i=t,t=l);var n=i.parentId||"parentId",a=i.name||"name",r=i.title||"title",s=i.avatar||"avatar";i.parentIdField=n,i.nameField=a,i.titleField=r,i.avatarField=s;var d=o.define(t,i);return n&&(d.parentIdField=n),a&&(d.nameField=a),r&&(d.titleField=r),s&&(d.avatarField=s),d};var h=s.extend({init:function(t){s.fn.init.call(this,i(!0,{},{schema:{modelBase:l,model:l}},t))},groupedItemsTree:function(t){var e=this._childrenMap(this.view()),i=e[this._defaultParentId()]||[],n=new a(i).group({field:t}).toArray();return this._innerGroupedItemsTree(t,n,e)},itemChildren:function(t,i){var n,r,s={field:"parentId",operator:"eq",value:null},o=this._sort&&this._sort.length?this._sort:{};if(r=i?this.view():this.data(),t){if((n=t.get("id"))===e||null===n||""===n)return[];s.value=n}return r=new a(r).filter(s).sort(o).toArray()},itemsTree:function(t,n){var r,s,o,d=[],l=this.itemChildren(t,!0);for(o=0;o<l.length;o++)(r=l[o]).get("expanded")&&(s=this.itemsTree(r,n),(r=i(!0,{},r)).children=s),r=i(!0,{},r),d.push(r);return null!==n&&n!==e&&(d=new a(d).group({field:n}).toArray()),d},prospectParents:function(t,e){var i,n,a,r=[],s=this.itemChildren(e,!1);for(a=0;a<s.length;a++)(i=s[a]).get("id")!==t.get("id")&&(r.push(i),i.get("hasChildren")&&(n=this.prospectParents(t,i),r=r.concat(n)));return r},read:function(t){return r.fn.read.call(this,t).then(this._loadExpanded.bind(this,t))},toggleChildren:function(i,n){var a=t.Deferred().resolve().promise(),r=i.loaded();return i._error&&(i.expanded=!1,i._error=e),void 0===n&&(n=!i.expanded),i.expanded=n,r||(a=this.load(i)),a},_innerGroupedItemsTree:function(t,e,i){var n,r,s,o,d,l,h;for(r=0;r<e.length;r++){for(n=e[r],l=[],!1,s=0;s<n.items.length;s++)h=n.items[s],!n.hasChildren&&h.hasChildren&&(n.hasChildren=!0),h.expanded&&(n.expanded=!0),o=n.items[s].get("id"),l=l.concat(i[o]);n.expanded&&(d=new a(l).group({field:t}).toArray(),n.children=this._innerGroupedItemsTree(t,d,i)),!n.hasChildren&&l.length>0&&(n.hasChildren=!0)}return e},_loadExpanded:function(t){var i,n,a;if(t)for(i=null!==t.id&&t.id!==e?this._byParentId(t.id):this._byParentId(this._defaultParentId()),n=0;n<i.length;n++)(a=i[n]).expanded&&!a.loaded()&&this.toggleChildren(a,!0)}});h.create=function(t){if(Array.isArray(t)?t={data:t}:t instanceof d&&(t={data:t.toJSON()}),!(t instanceof h)&&t instanceof r)throw new Error("Incorrect DataSource type. Only OrgChartDataSource instances are supported");return t instanceof h?t:new h(t)},i(!0,kendo.data,{OrgChartModel:l,OrgChartDataSource:h})}(window.kendo.jQuery),function(t,e){var i=window.kendo,n=i.keys,a=i.htmlEncode,r=t.extend,s=".kendoOrgChartView",o="click",d="collapse",l="expand",h="menu",c="select",u=".",p=" ",f="#",g="tabindex",m="uid",_="px",v="plus",k="minus",I="aria-owns",b="aria-selected",y="k-orgchart",C="k-orgchart-line",w="k-orgchart-line-v",x="k-orgchart-line-h",S="k-orgchart-line-v-top",F="k-orgchart-group",T="k-orgchart-group-v",E="k-orgchart-group-h",D="k-orgchart-node-group",H="k-orgchart-node-group-container",j="k-orgchart-node-container",P="k-orgchart-node",q="k-orgchart-card",L="k-orgchart-card-menu",W="k-orgchart-button",O="k-focus",N=".k-i-plus,.k-svg-i-plus",G="k-vstack",B="k-hstack",M=function(t){var e=t.label;return'<div role="tree" aria-orientation="horizontal" aria-label="'+a(e)+'" class="k-orgchart-group k-orgchart-level-1 k-pos-absolute k-hstack k-justify-content-center"></div>'},A=function(t){var e=t.guid,i=t.level;return'<div role="group" id="'+a(e)+'" class="k-orgchart-level-'+a(i)+' k-orgchart-group k-pos-absolute k-justify-content-around"></div>'},R=function(t){var e=t.hasChildren,i=t.guid,n=t.expanded,r=t.level,s='<div role="treeitem" ';return e&&i&&(s+="aria-owns="+a(i)+" ",s+=n?'aria-expanded="true" ':'aria-expanded="false" '),s+='aria-keyshortcuts="Enter" aria-level="'+a(r)+'" aria-selected="false" class="k-orgchart-node-group-container">'},V=function(t){var e=t.label,n=t.buttonSign;return i.html.renderButton('<button aria-label="'+a(e)+'" tabindex="-1" class="k-orgchart-button"></button>',{icon:a(n)})},U=function(t){var e=t.color,n=t.avatar,r=t.name,s=t.title,o=t.editable,d=t.menuLabel,l='<div class="k-card-body k-hstack" style="border-color:'+a(e)+'">';return n&&(l+='<div class="k-avatar k-avatar-solid-primary k-avatar-solid k-avatar-lg k-rounded-full"><span class="k-avatar-image"><img alt="'+a(r)+'" src="'+a(n)+'"></span></div>'),l+='<div class="k-vstack k-card-title-wrap"><div class="k-card-title k-text-ellipsis">'+a(r)+"</div>",s&&(l+='<span class="k-spacer"></span><div class="k-card-subtitle k-text-ellipsis">'+a(s)+"</div>"),l+="</div>",o&&(l+='<span class="k-spacer"></span><div class="k-card-body-actions">'+i.html.renderButton('<button class="k-orgchart-card-menu" role="button" aria-label="'+a(d)+'" tabindex="-1"></button>',{icon:"more-vertical",fillMode:"flat"})+"</div>"),l+="</div>"},Q=function(t){var e=t.uid,i=t.guid,n=t.hasChildren,r=t.expanded,s=t.cssClass,o=t.level,d='<div role="treeitem" data-uid="'+a(e)+'" ';return n&&i&&(d+="aria-owns="+a(i)+" ",d+=r?'aria-expanded="true" ':'aria-expanded="false" '),d+='class="k-orgchart-card k-card ',s&&(d+=""+a(s)),d+='" aria-keyshortcuts="Enter" aria-level="'+a(o)+'" aria-selected="false"></div>'},z=function(t){var e=t.uid,i=t.level,n=t.cssClass;return'<div role="treeitem" data-uid="'+a(e)+'" aria-level="'+a(i)+'" aria-selected="false" aria-keyshortcuts="Enter" class="k-orgchart-card k-card '+(n?a(n):"")+'"></div>'},J=i.Observable.extend({init:function(t,e){this.element=t,this.options=e||{},i.Observable.fn.init.call(this),this._attachEvents()},events:[d,l,c,h],destroy:function(){i.ui.Widget.fn.destroy.call(this),this.element.off(s)},collapse:function(){return!1},expand:function(){return!1},jqueryGroupElement:function(t){if(t){var e=this._processItem(t);return e.hasClass(H)||(e=e.closest(u+H)),e&&e.length?e:null}},jqueryItemElement:function(t){if(t){var e=this._processItem(t);return e.hasClass(q)||(e=e.closest(u+q)),e&&e.length?e:null}},refresh:function(){this._cacheFocused(),this._clearContent(),this._generateItemsTree(),this._calculateLevels(),this._render()},select:function(t){var e=this._getToSelect(t),i=this.element.find("[tabindex=0]");e&&(i.removeAttr(g).removeClass(O).attr(b,!1),e.attr(g,"0").addClass(O).trigger("focus").attr(b,!0))},_attachEvents:function(){var t=u+q+","+u+H;this.element.on("keydown"+s,t,this._onKeyDown.bind(this)).on(o+s,t,this._onSelect.bind(this)).on(o+s,u+W,this._onButtonClick.bind(this)).on("focus"+s,t,this._onFocus.bind(this)).on("blur"+s,u+O,this._onBlur.bind(this))},_cacheFocused:function(){var t=this.element.find("[tabindex='0']"),e=this._dataItems(t);t.length&&e&&e.length&&!this._idTabIndex&&(this._idTabIndex=e[0].get("id"),t.hasClass(O)?this._shouldRestoreSelection=!0:this._shouldRestoreSelection=!1)},_calculateDimensions:function(){var t=this.element.find(u+this._selector).first();this._buttonHeight||(this._buttonHeight=this.element.find(u+W).first().outerHeight()),this._spacing||(this._spacing=this.element.find(u+w).first().outerHeight()),this._itemWidth||(this._itemWidth=this._calculateItemWidth()),this._itemHeight||(this._itemHeight=t.outerHeight(!0))},_calculateItemWidth:function(){return!1},_calculateLevel:function(){return!1},_calculateLevels:function(){return!1},_clearContent:function(){this.element.empty()},_dataItem:function(t){var e=this.jqueryItemElement(t);if(e&&e.data(m))return this.dataSource.getByUid(e.data(m))},_dataItems:function(){return!1},_generateItemsTree:function(){return!1},_getToSelect:function(){return!1},_groupIsVertical:function(){return!1},_keyCollapse:function(){return!1},_keyExpand:function(){return!1},_keyNext:function(){return!1},_keyPrev:function(){return!1},_keyEnter:function(){return!1},_keyEscape:function(){return!1},_keyEnd:function(){var t=this.element.find(u+q).last();this.element.find("[tabindex=0]")[0]!==t[0]&&this.trigger(c,{item:t,dataItems:[this._dataItem(t)]})},_keyHome:function(){var t=this.element.find(u+q).first();this.element.find("[tabindex=0]")[0]!==t[0]&&this.trigger(c,{item:t,dataItems:[this._dataItem(t)]})},_onBlur:function(){this.element.find(u+O).removeClass(O)},_onKeyDown:function(t){var e=t.keyCode,a=this.element.find("[tabindex=0]"),r=i.support.isRtl(this.element),s=r?[n.LEFT]:[n.RIGHT],o=r?[n.RIGHT]:[n.LEFT],d=n.DOWN,l=n.UP;a&&(this._groupIsVertical(a)&&(s.push(n.DOWN),o.push(n.UP)),e===n.HOME?this._keyHome():e===n.END?this._keyEnd():s.indexOf(e)>-1?(t.preventDefault(),t.stopPropagation(),this._keyNext(a)):o.indexOf(e)>-1?(t.preventDefault(),t.stopPropagation(),this._keyPrev(a)):e===d?(t.preventDefault(),t.stopPropagation(),this._keyExpand(a)):e===l?(t.preventDefault(),t.stopPropagation(),this._keyCollapse(a)):e===n.ENTER?this._keyEnter(a):e===n.ESC&&this._keyEscape(a))},_onButtonClick:function(e){var i,n=this,a=t(e.currentTarget),r=a.find(N).length>0,s=a.siblings(u+this._selector),o=this._dataItems(s);if(r){if(n.trigger(l,{item:s,dataItems:o}))return}else if(n.trigger(d,{item:s,dataItems:o}))return;for(i=0;i<o.length;i++)n.dataSource.toggleChildren(o[i],r).then(this.refresh.bind(this))},_onFocus:function(){return!1},_onSelect:function(){return!1},_orientation:function(){return!1},_processItem:function(e){var n;return"string"===t.type(e)?n=this.element.find(e):i.isElement(e)?n=t(e):e instanceof jQuery&&(n=e),n},_render:function(){var e,n=this._itemsTree,a=t(i.template(M)({label:this.options.messages.label})),r=this.element,s=this._total,o=r.closest(u+y).css("padding-left");r.append(a),this._renderGroup(a,n,1,this._total,0),e=s*this._itemWidth+(s-1)*this._spacing,a.width(e),r.width(e+Number(o.split(_)[0])),this._setHeight(),this._restoreSelection()},_renderNode:function(e,n,a,s,o){var d,l,h=this.options.messages,c=this.options.cardsColors||i.getSeriesColors(),u=t('<div class="k-orgchart-node k-vstack k-align-items-center"></div>');return l=t(e(r(!0,{},a,{menuLabel:h.menuLabel,level:s,guid:o,editable:!!this.options.editable,color:c[s-1]||c[0]}))),a.attributes&&l.attr(JSON.parse(JSON.stringify(a.attributes))),d=t(n(r(!0,{},a,{menuLabel:h.menuLabel,level:s,guid:o,editable:!!this.options.editable,color:c[s-1]||c[0]}))),l.append(d),u.append(l),u},_renderGroup:function(){return!1},_restoreSelection:function(){var t,e;this._idTabIndex?((e=(t=this.dataSource.get(this._idTabIndex))?this._getToFocus(t):this.element.find(u+this._selector).first()).attr(g,"0"),this._idTabIndex=null):(e=this.element.find(u+this._selector).first()).attr(g,"0"),this._shouldRestoreSelection&&(this._shouldRestoreSelection=!1,this._preventTriggerSelect=!0,e.trigger("focus"),e.addClass(O))},_setHeight:function(){var e,i=this._selector,n=this.element.find(u+W+","+u+i),a=Number.MAX_VALUE,r=0;this._calculateDimensions(),e=this._buttonHeight,this.element.find(u+S).height(this._spacing+e/2),n.each((function(e,i){var n=t(i).offset().top,s=n+t(i).outerHeight(!0);n<a&&(a=n),s>r&&(r=s)})),this.element.height(r-a)}}),K=J.extend({init:function(t,e){J.fn.init.call(this,t,e),this._selector=q},collapse:function(t){var e=this.jqueryItemElement(t);e&&this.dataSource.toggleChildren(this._dataItem(e),!1).then(this.refresh.bind(this))},expand:function(t){var e=this.jqueryItemElement(t);e&&this.dataSource.toggleChildren(this._dataItem(e),!0).then(this.refresh.bind(this))},_calculateItemWidth:function(){return this.element.find(u+this._selector).first().outerWidth(!0)},_calculateLevel:function(t,e){var i,n,a,r=t.length,s=this._maxColumnsPerLevel,o=!1,d=!1;for((!s[e]||s[e]<r)&&(i=s[e],d=!0,s[e]=r),n=0;n<r;n++)(a=t[n]).hasChildren&&(o=!0,a.expanded&&this._calculateLevel(a.children,e+1));!o&&d&&e>0&&(d=!1,s[e]=i||1)},_calculateLevels:function(){var t,e=this._itemsTree,i=this._maxColumnsPerLevel=[],n=1;for(this._calculateLevel(e,0),t=0;t<i.length;t++)n*=i[t];this._total=n},_dataItems:function(t){var e=this.dataSource.getByUid(t.data(m));return e?[e]:null},_generateItemsTree:function(){this._itemsTree=this.dataSource.itemsTree()},_getToFocus:function(t){return this.element.find("[data-uid='"+t.get(m)+"']")},_getToSelect:function(t){return this.jqueryItemElement(t)},_groupIsVertical:function(t){return t.closest(u+F).hasClass(T)},_keyCollapse:function(t){var e,i,n=this._dataItem(t);n.expanded?this.trigger(d,{item:t,dataItems:[n]})||this.collapse(t):n.parentId&&(e=this.dataSource.get(n.parentId).get(m),i=this.element.find("[data-uid='"+e+"']"),this.trigger(c,{item:i,dataItems:[this._dataItem(i)]}))},_keyEnter:function(t){t.find(u+L).length>0&&this.trigger(h,t)},_keyExpand:function(t){var e,i=this._dataItem(t),n=this.element.find(f+t.attr(I));i.hasChildren&&(i.expanded?(e=n.find(u+this._selector).first(),this.trigger(c,{item:e,dataItems:[this._dataItem(e)]})):this.trigger(l,{item:t,dataItems:[i]})||this.expand(t))},_keyNext:function(t){var e=this._dataItem(t),i=t.parent().next(u+P).find(u+q),n=this.element.find(f+t.attr(I));!i.length&&e.hasChildren&&e.expanded&&(i=n.find(u+q).first()),0===i.length||i.hasClass(O)||this.trigger(c,{item:i,dataItems:[this._dataItem(i)]})},_keyPrev:function(t){var e,i=this._dataItem(t),n=t.parent().prev(u+P).find(u+q);!n.length&&i.parentId&&(e=this.dataSource.get(i.parentId).get(m),n=this.element.find("[data-uid='"+e+"']")),0===n.length||n.hasClass(O)||this.trigger(c,{item:n,dataItems:[this._dataItem(n)]})},_onFocus:function(e){var i=t(e.currentTarget),n=t(e.target);if(this._preventTriggerSelect)return e.stopPropagation(),void(this._preventTriggerSelect=!1);if(n.hasClass(L)){if(n.closest("[tabindex='0']").length>0)return void e.stopPropagation();this._preventTriggerSelect=!0}i.hasClass(q)||(i=i.closest(u+q)),i.hasClass(O)||this.trigger(c,{item:i,dataItems:[this._dataItem(i)]})},_onSelect:function(e){var i=t(e.currentTarget),n=i.hasClass(q)?i:i.closest(u+q);(t(e.target).hasClass(L)?t(e.target):t(e.target).closest(u+L)).length>0||i.hasClass(O)||this.trigger(c,{item:n,dataItems:[this._dataItem(n)]})},_orientation:function(e,i,n){var a=t("<div>").addClass(C+p+w);n&&i>1?(e.addClass(T+p+G),e.find(u+j).addClass(G),0===e.find(u+W).length||1===e.find(u+q).length?(e.find(u+q).before(a.clone()),e.find(u+P).first().find(u+w).addClass(S)):i>1&&e.find(u+q).first().before(a.clone())):(e.addClass(E+p+B),e.find(u+j).addClass(B),i>1&&e.find(u+q).before(a.clone().addClass(S)))},_renderGroup:function(e,i,n,a,r){var s,o;o=t('<div class="k-orgchart-node-container k-justify-content-around" style="width:100%"></div>'),e.append(o),s=this._renderInner(o,i,n,a,r),this._orientation(e,n,s)},_renderInner:function(e,n,a,r,s){var o,d,l,h,c,f,g,m,I,b=i.template(V),y=i.template(Q),S=r/n.length,F=!0,T=t("<div>").addClass(C+p+w),D=t("<div>").addClass(C+p+x),H=this.options.messages;for(I=this.options.template?"function"==typeof this.options.template?this.options.template:i.template(this.options.template):i.template(U),o=0;o<n.length;o++)d=n[o],l=i.guid(),h=this._renderNode(y,I,d,a,l),d.hasChildren&&(h.append(T.clone()),c=t(b({buttonSign:d.expanded?k:v,label:d.expanded?H.collapse:H.expand})),h.append(c)),e.append(h),this._calculateDimensions(),g=this._itemWidth,m=this._spacing,d.hasChildren&&(F=!1,d.expanded&&(f=this._renderInnerGroup(d,S,s,o,a,l))),f&&f.hasClass(E)&&d.expanded&&d.children&&d.children.length>1&&c.after(D.clone().css({width:(S-S/d.children.length)*(g+m)+_,"margin-top":this._buttonHeight/-2+_}));return S>1&&!F&&e.find(u+P).width((S-1)*(m+g)),F},_renderInnerGroup:function(e,n,a,r,s,o){var d,l=this._itemWidth,h=this._spacing,c=n*l+(n-1)*h,u=r*n*l+a,p=i.template(A),f=i.support.isRtl(this.element)?"right":"left",g=s*(this._itemHeight+this._buttonHeight+h)+h*(s-1)-this._buttonHeight/2;return r>0&&(u+=r*n*h),(d=t(p({guid:o,level:s+1}))).css({width:c+_,top:g+_}),d.css(f,u+_),this.element.append(d),this._renderGroup(d,e.children,s+1,n,u),d}}),X=J.extend({init:function(t,e){J.fn.init.call(this,t,e),this._selector=H},collapse:function(t){var e,i,n=this.jqueryGroupElement(t);if(n)for(e=this._dataItems(n),i=0;i<e.length;i++)this.dataSource.toggleChildren(e[i],!1).then(this.refresh.bind(this))},expand:function(t){var e,i,n=this.jqueryGroupElement(t);if(n)for(e=this._dataItems(n),i=0;i<e.length;i++)this.dataSource.toggleChildren(e[i],!0).then(this.refresh.bind(this))},_dataItems:function(t){var e,i,n=this.dataSource,a=[];return t.hasClass(q)?(e=n.getByUid(t.data(m)))&&a.push(e):t.hasClass(H)&&(this._groupFocused=!0,t.find(u+q).each((function(t,e){(i=n.getByUid(e.getAttribute("data-uid")))&&a.push(i)}))),a},_calculateItemWidth:function(){var t=this.element.find(u+this._selector).first();return this.element.find(u+q).first().outerWidth(!0)+2*Number(t.css("padding-left").split(_)[0])+2*Number(t.css("border-left").split(_)[0])},_calculateLevel:function(t,e){var i,n,a,r=t.length,s=!1,o=0;for(this._maxColumnsPerLevel[e]=this._maxColumnsPerLevel[e]||0,this._maxGroups[e]=this._maxGroups[e]||0,n=0;n<r;n++)(i=(a=t[n]).items.length)>o&&(o=i),(a=t[n]).hasChildren&&(s=!0,a.expanded&&this._calculateLevel(a.children,e+1));r>this._maxGroups[e]&&(this._maxGroups[e]=r),s||(o=1),o>this._maxColumnsPerLevel[e]&&(this._maxColumnsPerLevel[e]=o)},_calculateLevels:function(){var t,e,i=this._itemsTree,n=this._maxColumnsPerLevel=[],a=this._maxGroups=[],r=1;for(this._calculateLevel(i,0),t=n.length-1;t>=0;t--)e=n[t]*a[t],r>n[t]?r*=a[t]:r<e&&(r=e);this._total=r},_generateItemsTree:function(){this._itemsTree=this.dataSource.groupedItemsTree(this.options.groupField)},_getToFocus:function(t){return this._groupFocused?(this._groupFocused=!1,this.element.find("[data-uid='"+t.get(m)+"']").closest(u+H)):this.element.find("[data-uid='"+t.get(m)+"']")},_getToSelect:function(t){return this.jqueryItemElement(t)||this.jqueryGroupElement(t)},_groupIsVertical:function(t){return t.closest(u+j).hasClass(G)},_keyCollapse:function(t){var e,i=[];(i=this._dataItems(t)).some((function(t){return t.expanded}))?(t.hasClass(q)&&(t=t.closest(u+H),i=this._dataItems(t)),this.trigger(d,{item:t,dataItems:i})||this.collapse(t)):i[0].parentId&&(e=this.dataSource.get(i[0].parentId).get(m),this.trigger(c,{item:this.element.find("[data-uid='"+e+"']").closest(u+this._selector),dataItems:i}))},_keyEnter:function(t){var e,i=[];t.hasClass(q)&&t.find(u+L).length>0?this.trigger(h,t):(e=t.find(u+q).first(),i=this._dataItems(e),this.trigger(c,{item:e,dataItems:i}))},_keyEscape:function(t){if(t.hasClass(q)){var e=t.closest(u+H),i=this._dataItems(e);this.trigger(c,{item:e,dataItems:i})}},_keyExpand:function(t){var e,i,n,a=t.attr(I)||t.closest(u+this._selector).attr(I),r=this.element.find(f+a),s=this._dataItems(t);e=s.some((function(t){return t.hasChildren})),e&&(i=s.some((function(t){return t.expanded})),i?(n=r.find(u+this._selector).first(),this.trigger(c,{item:n,dataItems:this._dataItems(n)})):(t.hasClass(q)&&(t=t.closest(u+H),s=this._dataItems(t)),this.trigger(l,{item:t,dataItems:s})||this.expand(t)))},_keyNext:function(t){var e,i=this.element.find(f+t.attr(I)),n=this._dataItems(t),a=n.some((function(t){return t.hasChildren})),r=n.some((function(t){return t.expanded}));!(e=t.hasClass(q)?t.parent().next(u+P).find(u+q):t.parent().next(u+D).find(u+H)).length&&a&&r&&(e=i.find(u+this._selector).first()),0!==e.length&&this.trigger(c,{item:e,dataItems:this._dataItems(e)})},_keyPrev:function(t){var e,i,n=this._dataItems(t);!(i=t.hasClass(q)?t.parent().prev(u+P).find(u+q):t.parent().prev(u+D).find(u+H)).length&&n[0].parentId&&(e=this.dataSource.get(n[0].parentId).get(m),i=this.element.find("[data-uid='"+e+"']").closest(u+this._selector)),0!==i.length&&this.trigger(c,{item:i,dataItems:this._dataItems(i)})},_onFocus:function(e){var i,n,a=t(e.target);if(this._preventTriggerSelect)return e.stopPropagation(),void(this._preventTriggerSelect=!1);if(a.hasClass(L)){if(a.closest("[tabindex='0']").length>0)return void e.stopPropagation();this._preventTriggerSelect=!0}a.hasClass(q)||a.hasClass(H)||((n=a.closest(u+q)).length||(n=a.closest(u+H)),a=n),0!==a.length&&(i=this._dataItems(a),a.hasClass(O)||(e.stopPropagation(),this.trigger(c,{item:a,dataItems:i})))},_onSelect:function(e){var i,n,a=t(e.target),r=this.element.find("[tabindex=0]");a.hasClass(q)||a.hasClass(H)||((n=a.closest(u+q)).length||(n=a.closest(u+H)),a=n),0!==a.length&&r[0]!==a[0]&&(i=this._dataItems(a),this.trigger(c,{item:a,dataItems:i}))},_orientation:function(e,i,n){var a=t("<div>").addClass(C+p+w+p+S);e.addClass(B),i>1&&e.find(u+H).before(a.clone()),n&&i>1?(e.find(u+j).removeClass(B),e.find(u+j).addClass(G)):e.addClass(E)},_renderChildren:function(e,n,a,r,s,o,d){var l,h,c,u,f,g,m,I=i.template(V),b=i.template(A),y=t("<div>").addClass(C+p+w),S=t("<div>").addClass(C+p+x),F=this.options.messages,T=!0,E=i.support.isRtl(this.element)?"right":"left";return e.hasChildren&&(T=!1,s.append(y.clone()),h=t(I({buttonSign:e.expanded?k:v,label:e.expanded?F.collapse:F.expand})),s.append(h),this._calculateDimensions(),g=this._itemWidth,m=this._spacing,e.expanded&&(f=g*a+(a-1)*m,c=n*a*g+o,u=r*(this._itemHeight+this._buttonHeight+m)+m*(r-1)-this._buttonHeight/2,n>0&&(c+=n*a*m),(l=t(b({guid:d,level:r+1}))).css({width:f+_,top:u+_}),l.css(E,c+_),this.element.append(l),this._renderGroup(l,e.children,r+1,a,c))),l&&e.expanded&&e.children&&e.children.length>1&&h.after(S.clone().css({width:(a-a/e.children.length)*(g+m)+_,"margin-top":this._buttonHeight/-2+_})),T},_renderGroup:function(t,e,n,a,s){var o,d,l,h,c,p,f=!0,g=a/e.length;for(l=0;l<e.length;l++)h=i.guid(),p=e[l],d=(o=this._renderNodesContainer(t,r(!0,{},p,{guid:h,level:n}))).closest(u+D),this._renderItems(o,p.items,n,h),c=this._renderChildren(p,l,g,n,d,s,h),f&&(f=c);var m=this._itemWidth*g+(g-1)*this._spacing;t.find(u+D).width(m),this._orientation(t,n,f)},_renderItems:function(t,e,n,a){var r,s,o,d,l=i.template(z);for(d=this.options.template?"function"==typeof this.options.template?this.options.template:i.template(this.options.template):i.template(U),r=0;r<e.length;r++)s=e[r],o=this._renderNode(l,d,s,n,a),t.append(o)},_renderNodesContainer:function(e,n){var a,r=i.template(R),s=t('<div class="k-orgchart-node-group k-align-items-center k-vstack">'),o=t('<div role="group" class="k-orgchart-node-container k-justify-content-around k-hstack" style="width:100%"></div>'),d=t(r(n));return a="function"==typeof this.options.groupHeaderTemplate?this.options.groupHeaderTemplate:i.template(this.options.groupHeaderTemplate),d.append(a({value:n.value,field:n.field})),d.append(o),s.append(d),e.append(s),o}});i.orgChart={View:J,SingleView:K,GroupedView:X}}(window.kendo.jQuery);return function(t,e){var i=window.kendo,n=i.htmlEncode,a=i.ui.DataBoundWidget,r=i.data.OrgChartDataSource,s=i.ui.ContextMenu,o=t.extend,d=Array.isArray,l="cancel",h="change",c="click",u="collapse",p="create",f="dataBinding",g="dataBound",m="delete",_="edit",v="error",k="expand",I="progress",b="save",y="select",C="requestStart",w=".",x="k-orgchart",S="k-orgchart-group",F="k-orgchart-node-group",T="k-orgchart-node",E="k-orgchart-card",D="k-orgchart-card-menu",H="k-focus",j="k-item",P="k-orgchart-avatar-preview",q="k-orgchart-update",L="k-orgchart-cancel",W=function(t){var e=t.edit;return"<li data-action='edit'>"+n(e)+"</li>"},O=function(t){var e=t.create;return"<li data-action='create'>"+n(e)+"</li>"},N=function(t){var e=t.destroy;return"<li data-action='destroy'>"+n(e)+"</li>"},G=function(t){var e=t.avatar,a=t.name,r=t.destroy,s=t.fileName;return'<div class="k-orgchart-avatar-preview k-hstack k-align-items-center k-pb-lg"><div class="k-avatar k-avatar-solid-primary k-avatar-solid k-avatar-lg k-rounded-full"><span class="k-avatar-image"><img src="'+n(e)+'" alt="'+n(a)+'"></span></div><div class="k-px-md">'+n(s)+"</div>"+i.html.renderButton('<button aria-label="'+n(r)+'"></button>',{icon:"trash",fillMode:"flat"})+"</div>"},B=function(t){var e=t.cancel,a=t.save;return'<div class="k-edit-buttons">'+i.html.renderButton('<button class="k-orgchart-update">'+n(a)+"</button>",{icon:"save",themeColor:"primary"})+i.html.renderButton('<button class="k-orgchart-cancel">'+n(e)+"</button>",{icon:"cancel-outline"})+"</div>"},M=a.extend({init:function(t,e,n){d(e)&&(e={dataSource:e}),e=e||{},a.fn.init.call(this,t,e),n&&(this._events=n),this._wrapper(),this._view(),this._dataSource(),this._contextMenu(),this.options.autoBind&&this.dataSource.fetch(),i.notify(this)},options:{name:"OrgChart",autoBind:!0,cardsColors:null,dataSource:{},editable:{create:!0,destroy:!0,fields:!0,form:{buttonsTemplate:function(){return""},orientation:"vertical"},parent:!0},groupField:null,groupHeaderTemplate:function(t){var e=t.value,i=t.field;return'<div><div class="k-orgchart-node-group-title">'+n(e)+'</div><div class="k-orgchart-node-group-subtitle">'+n(i)+"</div></div>"},template:null,messages:{label:"Org Chart",edit:"Edit",create:"Create",destroy:"Delete",destroyContent:"Are you sure you want to delete this item and all its children?",destroyTitle:"Delete item",cancel:"Cancel",save:"Save",menuLabel:"Edit menu",uploadAvatar:"Upload new avatar",parent:"Parent",name:"Name",title:"Title",none:"--None--",expand:"expand",collapse:"collapse"}},events:[l,h,u,p,f,g,m,_,k,"kendoKeydown",b,y],destroy:function(){this._menu&&this._menu.destroy(),this._editWindow&&this._editWindow.destroy(),this._confirmDestroy&&this._confirmDestroy.destroy(),this.view.destroy(),a.fn.destroy.call(this),this.wrapper.off(".kendoOrgChart")},setDataSource:function(t){this.options.dataSource=t,this._dataSource(),this.options.autoBind&&t.fetch()},setOptions:function(t){a.fn.setOptions.call(this,t)},append:function(t,e){var i=this,n=i.view.jqueryItemElement(e),a=i.dataItem(n);n&&a&&(a.loaded()?(i.dataSource.add(o({},t,{parentId:a.id})),i.dataSource.sync()):i.dataSource.read({id:a.id}).then((function(){i.dataSource.add(o({},t,{parentId:a.id})),i.dataSource.sync()})))},cancelChanges:function(){this.dataSource.hasChanges()&&this.dataSource.cancelChanges()},collapse:function(t){return this.view.collapse(t)},dataItem:function(t){var e=this.view.jqueryItemElement(t);if(e&&e.data("uid"))return this.dataSource.getByUid(e.data("uid"))},delete:function(t){var e=this.view.jqueryItemElement(t);e&&(this.dataSource.remove(this.dataItem(e)),this.dataSource.sync())},edit:function(t){var e=this.view.jqueryItemElement(t),i=this.dataItem(e);e&&i&&this._edit(i)},expand:function(t){return this.view.expand(t)},getCollapsedNodes:function(){return this.wrapper.find("[aria-expanded='false']")},items:function(){return this.wrapper.find(w+E)},parent:function(t){var e,i=this.view.jqueryItemElement(t);if(i)return e=i.closest(w+S).attr("id"),this.wrapper.find("[aria-owns='"+e+"']")},saveChanges:function(){this.dataSource.sync()},select:function(t){var e=this.view._getToSelect(t);return e?this.view.select(e):void 0},_avatarPreview:function(t,e){var n,a,r=this._form,s=t.avatar;r&&(e||(e=s.split("\\").pop().split("/").pop())&&-1!=e.indexOf(".")||(e=t.name),a={name:t.name,avatar:s,fileName:e,destroy:this.options.messages.destroy},(n=r.wrapper).find(w+P).remove(),n.find('[type="file"]').closest(".k-form-field").prepend(i.template(G)(a)),n.find(w+P+" "+".k-button").on(c,(function(){n.find(w+P).remove(),t.set("avatar",null)})))},_contextMenu:function(){var t,e=this.options,i=e.editable,n=e.messages,a={target:this.wrapper,filter:w+D,select:this._onMenuItemClick.bind(this),activate:this._onMenuOpen.bind(this),deactivate:this._onMenuClose.bind(this),showOn:"click",animation:!1};(!0===i||!1!==i&&(i.create||i.destroy||i.fields||i.parent))&&(t=function(t,e){var i="<ul>";return!0===e?(i+=W(t),i+=O(t),i+=N(t)):((e.fields||e.parent)&&(i+=W(t)),e.create&&(i+=O(t)),e.destroy&&(i+=N(t))),i}(n,i),this._menu=new s(t,a))},_dataSource:function(){var t=this.dataSource,e=this.options.dataSource;t&&(t.unbind(h,this._dataSourceChangeHandler),t.unbind(v,this._errorHandler),t.unbind(I,this._progressHandler),t.unbind(C,this._requestStartHandler)),this._dataSourceChangeHandler=this._onDataSourceChange.bind(this),this._errorHandler=this._onDataSourceError.bind(this),this._progressHandler=this._progress.bind(this),this._requestStartHandler=this._onDataSourceRequestStart.bind(this),(t=this.dataSource=r.create(e)).bind(h,this._dataSourceChangeHandler),t.bind(v,this._errorHandler),t.bind(I,this._progressHandler),t.bind(C,this._requestStartHandler),this.view.dataSource=t},_destroyItem:function(e){var n=this,a=t("<div></div>"),r=n.options.messages,s=this._confirmDestroy=new i.ui.Confirm(a,{title:r.destroyTitle,content:r.destroyContent,messages:{okText:r.destroy,cancel:r.cancel},show:function(){setTimeout((function(){s.element.trigger("focus")}))}});s.open(),s.result.done((function(){n.trigger(m,{dataItem:e})||(n.dataSource.remove(e),n.dataSource.sync()),n.view._shouldRestoreSelection=!0,n.view._restoreSelection()})),s.result.fail((function(){n.wrapper.find(w+E+"[tabindex=0],"+w+F+"[tabindex=0]").addClass(H).trigger("focus")}))},_edit:function(e){var n,a=this,r=t("<div>"),s=t("<div>"),o=this.options.messages,d=this._formOptions(e);d&&(a._form=new i.ui.Form(r,d),e.avatar&&a._avatarPreview(e),s.append(r),a._editWindow=new i.ui.Window(s,{title:o.edit,width:"380 px",modal:!0,close:function(t){n?n=!1:a.trigger(l,{dataItem:e})?t.preventDefault():a.cancelChanges()},deactivate:function(){a._editWindow.wrapper.off(c),a._editWindow.destroy(),a._editWindow=null,a.view._restoreSelection()}}),s.after(i.template(B)({save:o.save,cancel:o.cancel})),a._editWindow.center().open(),a._editWindow.wrapper.on(c,w+q,(function(){a._form.validate()&&(n=!0,a.trigger(b,{dataItem:e})||(a._editWindow.close(),a.saveChanges()))})),a._editWindow.wrapper.on(c,w+L,(function(){a._editWindow.close()})))},_formOptions:function(t){var e,i,n=this.options,a=n.messages,r=n.editable.form,s=[];return r&&(i=r.items),i&&0!==i.length||!(!0===n.editable||n.editable&&n.editable.parent)||(e=[{id:null,name:a.none}].concat(this.dataSource.prospectParents(t)),s.push({field:"parentId",editor:"DropDownList",label:a.parent,editorOptions:{dataSource:e,dataValueField:"id",dataTextField:"name",valuePrimitive:!0}})),i&&0!==i.length||!(!0===n.editable||n.editable&&n.editable.fields)||(s=s.concat([{field:"name",label:a.name,validation:{required:!0}},{field:"title",label:a.title},{field:"avatar",label:a.uploadAvatar,editor:this._uploadEditor.bind(this,t)}])),r&&delete r.formData,!!(s.length>0||i&&i.length>0)&&o(!0,{},{formData:t,items:s},r)},_onDataSourceChange:function(t){"add"===t.action||"itemchange"===t.action&&this._editWindow||(t.action&&"sync"!==t.action||!this.trigger(f,t)?(this._progress(!0),this.view.refresh(),t.action&&"sync"!==t.action||this.trigger(g),this._progress(!1)):this._progress(!1))},_onDataSourceError:function(){this._progress(!1)},_onDataSourceRequestStart:function(){this.view._cacheFocused()},_onMenuClose:function(){0===t(document.activeElement).closest("[role='alertdialog']").length&&this.wrapper.find("[tabindex='0']").addClass(H).trigger("focus")},_onMenuItemClick:function(e){var i,n=this,a=t(e.target).closest(w+T).find(w+E),r=n.dataItem(a),s=t(e.item).data("action");r&&(s===_?n.trigger(_,{dataItem:r})||n._edit(r):s===p?n.trigger(p,{dataItem:r})||(r.loaded()?(i=n.dataSource.add({parentId:r.id}),n._edit(i)):n.dataSource.read({id:r.id}).then((function(){i=n.dataSource.add({parentId:r.id}),n._edit(i)}))):"destroy"===s&&n._destroyItem(r))},_onMenuOpen:function(){this.view._cacheFocused(),this.wrapper.find(w+H).removeClass(H),this._menu.element.find(w+j).first().trigger("focus")},_openMenu:function(t){this._menu&&this._menu.open(t.find(w+D))},_progress:function(t){i.ui.progress(this.container,t)},_triggerCollapse:function(t){this.trigger(u,{item:t.item,dataItems:t.dataItems})&&t.preventDefault()},_triggerExpand:function(t){this.trigger(k,{item:t.item,dataItems:t.dataItems})&&t.preventDefault()},_triggerSelect:function(t){this.trigger(y,{item:t.item,dataItems:t.dataItems})||(this.view.select(t.item),this.trigger(h,{item:t.item,dataItems:t.dataItems}))},_uploadEditor:function(e,i){var n=this;t('<input type="file">').appendTo(i).kendoUpload({async:!1,multiple:!1,select:function(t){var i=t.files[0],a=i.rawFile,r=new FileReader;i.validationErrors&&i.validationErrors.length>0||a&&(r.onloadend=function(){e.set("avatar",this.result),n._avatarPreview(e,a.name)},r.readAsDataURL(a))},validation:{allowedExtensions:[".gif",".jpg",".png"],maxFileSize:1048576}})},_view:function(){null!==this.options.groupField&&undefined!==this.options.groupField?this.view=new i.orgChart.GroupedView(this.container,this.options):this.view=new i.orgChart.SingleView(this.container,this.options),this.view.bind(y,this._triggerSelect.bind(this)),this.view.bind(k,this._triggerExpand.bind(this)),this.view.bind(u,this._triggerCollapse.bind(this)),this.view.bind("menu",this._openMenu.bind(this))},_wrapper:function(){var e=t("<div class='k-orgchart-container'>");this.wrapper=this.element,this.container=e,this.wrapper.addClass(x),this.wrapper.append(e)}});i.ui.plugin(M)}(window.kendo.jQuery),kendo}));
//# sourceMappingURL=kendo.orgchart.min.js.map

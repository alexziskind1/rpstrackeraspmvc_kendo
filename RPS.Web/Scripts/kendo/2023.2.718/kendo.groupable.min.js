/**
 * Kendo UI v2023.2.718 (http://www.telerik.com/kendo-ui)
 * Copyright 2023 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Kendo UI commercial licenses may be obtained at
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("kendo.core.js"),require("kendo.draganddrop.js"),require("kendo.chip.js"),require("kendo.chiplist.js"),require("kendo.icons.js")):"function"==typeof define&&define.amd?define(["kendo.core.min","kendo.draganddrop.min","kendo.chip.min","kendo.chiplist.min","kendo.icons.min"],t):((e="undefined"!=typeof globalThis?globalThis:e||self).kendogroupable=e.kendogroupable||{},e.kendogroupable.js=t())}(this,(function(){return function(e,t){var r=window.kendo,n=r.ui.Widget,i=r._outerWidth,a=r.attr,o=e.extend,s=e.each,d=!1,l="asc",c="group-sort",g="k-grouping-drop-container",p=function(t){var n=t.attr(r.attr("title"));return n&&(n=r.htmlEncode(n)),e('<div class="k-group-clue k-drag-clue" />').html(n||t.attr(r.attr("field"))).prepend(r.ui.icon({icon:"cancel",iconClass:"k-drag-status"}))},u=e('<div class="k-grouping-dropclue"/>');function f(e){e.contents().filter((function(){return 3===this.nodeType})).remove()}var h=n.extend({init:function(t,a){var s,l,h=this,m=r.guid(),_=h._intializePositions.bind(h);h._dropCuePositions=[];n.fn.init.call(h,t,a),d=r.support.isRtl(t),l=d?"right":"left",h.draggable=s=h.options.draggable||new r.ui.Draggable(h.element,{filter:h.options.draggableElements,hint:p,group:m}),h.groupContainer=e(h.options.groupContainer,h.element).kendoDropTarget({group:s.options.group,dragenter:function(e){h._canDrag(e.draggable.currentTarget)&&(r.ui.icon(e.draggable.hint.find(".k-drag-status"),{icon:"plus"}),u.css(l,0).appendTo(h.groupContainer))},dragleave:function(e){r.ui.icon(e.draggable.hint.find(".k-drag-status"),{icon:"cancel"}),u.remove()},drop:function(t){var n,i=t.draggable.currentTarget,a=i.attr(r.attr("field")),s=i.attr(r.attr("title")),l=i.attr("id"),g=h.indicator(a),p=h._dropCuePositions,m=p[p.length-1],_="after",v=d||!m?0:m.element.parent().position().left,b=o({},h.options.sort,i.data(c)),C=b.dir;(i.hasClass("k-chip")||h._canDrag(i))&&(m?(n=h._dropCuePosition(r.getOffset(u).left+v+parseInt(m.element.css("marginLeft"),10)*(d?-1:1)+parseInt(m.element.css("marginRight"),10)))&&h._canDrop(e(g),n.element,n.left)&&(n.before&&(_="before"),n.element[_](g||h.buildIndicator(a,s,C,l).wrapper),h._setIndicatorSortOptions(a,b),h._change()):(f(h._messageContainer),h._list.element.show(),h._list.add(h.buildIndicator(a,s,C,l).element),h._setIndicatorSortOptions(a,b),h._change()))}}).kendoDraggable({filter:"div.k-chip",hint:p,group:s.options.group,dragcancel:h._dragCancel.bind(h),dragstart:function(e){var t=e.currentTarget,n=parseInt(t.css("marginLeft"),10),a=t.position(),o=d?a.left-n:a.left+i(t);_(),u.css("left",o).appendTo(h.groupContainer),r.ui.icon(this.hint.find(".k-drag-status"),{icon:"plus"})},dragend:function(){h._dragEnd(this)},drag:h._drag.bind(h)}),s.bind(["dragend","dragcancel","dragstart","drag"],{dragend:function(){h._dragEnd(this)},dragcancel:h._dragCancel.bind(h),dragstart:function(e){h.options.allowDrag||h._canDrag(e.currentTarget)?_():e.preventDefault()},drag:h._drag.bind(h)}),h.dataSource=h.options.dataSource,h._messageContainer=h.groupContainer.find("."+g),h._messageContainer.length||(h._messageContainer=e("<div/>").addClass(g).appendTo(h.groupContainer)),h._createList(),h.dataSource&&h._refreshHandler?h.dataSource.unbind("change",h._refreshHandler):h._refreshHandler=h.refresh.bind(h),h.dataSource&&(h.dataSource.bind("change",h._refreshHandler),h.refresh())},refresh:function(){var t=this,r=t.dataSource.group()||[],n=a("field"),i=a("title");t.groupContainer&&(t._list&&(t._list.remove(t._list.items()),t._list.element.hide()),r.length&&f(t._messageContainer),s(r,(function(r,a){var s=a.field,d=a.dir,l=t.element.find(t.options.filter).filter((function(){return e(this).attr(n)===s})),c=t.buildIndicator(s,l.attr(i),d,l.attr("id"));t._list.add(c.element),t._list.element.show(),t._setIndicatorSortOptions(s,o({},t.options.sort,{dir:d,compare:a.compare}))}))),t._invalidateGroupContainer()},destroy:function(){var e=this;n.fn.destroy.call(e),e.groupContainer.off(".kendoGroupable"),e.groupContainer.data("kendoDropTarget")&&e.groupContainer.data("kendoDropTarget").destroy(),e.groupContainer.data("kendoDraggable")&&e.groupContainer.data("kendoDraggable").destroy(),e.options.draggable||e.draggable.destroy(),e.dataSource&&e._refreshHandler&&(e.dataSource.unbind("change",e._refreshHandler),e._refreshHandler=null),e._list&&e._list.destroy(),e.groupContainer=e.element=e.draggable=null},events:["change","removeGroup"],options:{name:"Groupable",filter:"th",draggableElements:"th",messages:{empty:"Drag a column header and drop it here to group by that column"},sort:{dir:l,compare:null}},indicator:function(t){var n=e(".k-chip",this.groupContainer);return e.grep(n,(function(n){return e(n).attr(r.attr("field"))===t}))[0]},removeHandler:function(e){this._removeIndicator(e.sender.wrapper)},clickHandler:function(e){var t=e.sender.wrapper.find(".k-chip-icon"),r=t.attr(a("dir"))===l?"desc":l;t.attr(a("dir"),r),this._change()},buildIndicator:function(t,n,i,a){var o,s,d,c=this;return i=i||(c.options.sort||{}).dir||l,s=(d=(o=e("<div/>").kendoChip({icon:"sort-"+("asc"==(i||"asc")?"asc-small":"desc-small"),iconClass:"k-chip-icon",label:""+(n||t),removable:!0,size:c.options.size||"medium",remove:c.removeHandler.bind(c),click:c.clickHandler.bind(c)}).data("kendoChip")).wrapper).find(".k-chip-icon").first(),d.attr("data-"+r.ns+"field",t),d.attr("data-"+r.ns+"title",n||""),a&&d.attr("data-"+r.ns+"id",a),s.attr("title","(sorted "+("asc"==i?"ascending":"descending")+")"),s.attr("data-"+r.ns+"dir",i),o},_setIndicatorSortOptions:function(t,r){e(this.indicator(t)).data(c,r)},aggregates:function(){var t,n,i;return this.element.find(this.options.filter).map((function(){var a=e(this),o=a.attr(r.attr("aggregates")),s=a.attr(r.attr("field"));if(o&&""!==o)for(t=o.split(","),o=[],n=0,i=t.length;n<i;n++)o.push({field:s,aggregate:t[n]});return o})).toArray()},descriptors:function(){var t,n=this,i=e(".k-chip",n.groupContainer),a=n.aggregates();return e.map(i,(function(i){i=e(i),t=i.attr(r.attr("field"));var o=n.options.sort||{},s=i.data(c)||{},d=i.find(".k-chip-icon");return{field:t,dir:d.attr(r.attr("dir")),aggregates:a||[],colID:i.attr(r.attr("id")),compare:s.compare||o.compare}}))},_removeIndicator:function(e){var t=this;t.trigger("removeGroup",{field:e.attr(r.attr("field")),colID:e.attr(r.attr("id"))}),t._list.remove(e),e.off(),e.removeData(),t._invalidateGroupContainer(),t._change()},_change:function(){var e=this;if(e.dataSource){var t=e.descriptors();if(e.trigger("change",{groups:t}))return void e.refresh();e.dataSource.group(t)}},_dropCuePosition:function(t){var r=this._dropCuePositions;if(u.is(":visible")&&0!==r.length){t=Math.ceil(t);var n=r[r.length-1],a=n.left,o=n.right,s=parseInt(n.element.css("marginLeft"),10),l=parseInt(n.element.css("marginRight"),10),c=n.element.parent().position().left-parseInt(this.groupContainer.css("paddingLeft"),10);return t>=o&&!d||t<a&&d?t={left:n.element.position().left+(d?c-s:i(n.element)+l),element:n.element,before:!1}:(t=e.grep(r,(function(e){return e.left<=t&&t<=e.right||d&&t>e.right}))[0])&&(t={left:d?t.element.position().left+i(t.element)+l+c:t.element.position().left-s,element:t.element,before:!0}),t}},_drag:function(e){var t=this._dropCuePosition(e.x.location);t&&u.css({left:t.left,right:"auto"})},_canDrag:function(e){var t=e.attr(r.attr("field"));return"false"!=e.attr(r.attr("groupable"))&&t&&(e.hasClass("k-chip")||!this.indicator(t))},_canDrop:function(e,t,r){var n=e.next();return e[0]!==t[0]&&(!n[0]||t[0]!==n[0]||!d&&r>n.position().left||d&&r<n.position().left)},_dragEnd:function(t){var n=this,i=t.currentTarget.attr(r.attr("field")),a=n.indicator(i);t!==n.options.draggable&&!t.dropped&&a&&n._removeIndicator(e(a)),n._dragCancel()},_dragCancel:function(){u.remove(),this._dropCuePositions=[]},_intializePositions:function(){var t,n=e(".k-chip",this.groupContainer);this._dropCuePositions=e.map(n,(function(n){return n=e(n),t=r.getOffset(n).left,{left:parseInt(t,10),right:parseInt(t+i(n),10),element:n}}))},_invalidateGroupContainer:function(){var e=this.groupContainer,t=this._list;e&&t&&t.element.is(":empty")&&this._messageContainer.text(this.options.messages.empty)},_createList:function(){var t=this;t.groupContainer.find(".k-chip-list").remove(),t._list=e("<div/>").kendoChipList({selectable:"none",size:t.options.size||"medium"}).data("kendoChipList"),t._list.element.insertBefore(t._messageContainer)}});r.ui.plugin(h)}(window.kendo.jQuery),kendo}));
//# sourceMappingURL=kendo.groupable.min.js.map
